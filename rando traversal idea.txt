to identify dead ends quickly, it becomes necessary to understand how we will move through layers
for end points, this is easy but for repeated segments, it could be tricky
what's needed to connect endpoints is a "minimum viable path"
Theorem P = any room that is strictly unnecessary can be added later without reducing the potential path set


we could connect all layers into a single graph
but intentionally repeat some layers multiple times
the number of times we repeat say the two-way layer could be static (4-5) or repeat until no new rooms gain a "path" to an endpoint
there is also the issue of repeated rooms in a path
this is irrelevant since any path that includes itself twice could work fine including itself only once accoirding to Theorem P

this also means that we can remove any path from the layer that exits into any door type that could connect to any start it has

this would leave us with layers that cannot loop into themselves, making it easier to identify when all paths have reached a dead end or an endpoint

from this minimum viable paths layer, we can use it to bridge edge points and dynamic edit it to exclude used paths during the walk
so we do not repeat paths in the same walk

may need t oinstead construct a unique mvp layer for each type of end point and each type of start point

constructing levels with multiple branches could be even trickier? could use similar theorem but where to end it?
could potentially go on forever... well thats right we dont actually need all possible paths
just the minimum viable ones
and we can construct branchs separately and insert them later if needed

or wait, can we?
it would be harder to find a spot to slot in a branch segment (front and back need to match) than to slot in just a start branch


MVP types:

Entrance > John (no branch level)
Entrance > Start Branch
Start Branch > End Branch
End Branch > Start Branch (Allows multiple branches in a level, like above)
Entrance Branch > John Branch
Entrance Branch > End Branch
Start Branch > John Branch
End Branch > John


So in summary:

Construct Minimum Viable Path (MVP) layers to connect end point layers
each MVP layer:
	* is made up of multiple of the underlying layer
	* lacks redundant or "unnecessary" rooms
	* cannot have repeated rooms in its paths, following the rules below


MVP Construction Rules:
	1. Disconnect paths that use a repeated exit (an exit type appearing previously in the path)
	2. Disconnect paths that could connect to a previous entrance (could we collapse with above rule somehow?)
    
    we could collapse it. if there is such an exit that connects to an entrance, that entrance must connect to a previously used exit (including the initial transition nodes as an "exit")
    we dont care that we remove a room that could be the singular room inbetween two end points this way because that room is redundant and we can add it in later
	
Algorithm:
	For all initial transition nodes:
	1. Flow forward along each path.
	1b. Terminate and remove edge that disobeys the above rules
	
	For all final paths:
	2. Flow backwards from end of paths
	2b. Terminate if path ends at exit transition node
	2c. Remove edge if there are no other neighbors to the edge start (IE, possibly supporting another path)

    may also want to include the length of the path as we shrink? maybe for viable paths, we do perform the flow backwards without edge removal, just to count the length of the path?
    no that wont work because of branches, or maybe we can store all viable found paths and their lengths and then just choose one
    may have to create some data structure to store info like length,a nd which branches to take to "reconstruct" the path of that length
    it would also store info on what type of exit that path has so we can quickly choose in cases where the end point matters (such as when adding redundant paths to the MVP)

Summary:
	Flow Forward: Grow path until redundant exit
	Flow Backward: Shrink path until branch
	Flow Backward: Shrink continues past branch if all other branches have already shrunk
	Repeat: Add a copy of just used layer and repeat the process


in the end not all paths terminate at the final layer's end branch
we use a copy of the layer we just processed because all paths that failed to grow in this iteration cannot possibly do so in the next

we also need to trim initial nodes that have no connection to any valid exit path 

because of how endpoint traversal works, each MVP layer does not verify that it can continue all the way to the a john end
in this case, what we can do is the following:

repeat the algorithm but for the larger layers, removing paths that do not end at at least one john exit

so now we also have to construct larger MVP layers for the following:

Entrance > John
Entrance > (Start Branch > End Branch) > John
Entrance > (Start Branch > John Branch)
Entrance Branch > (End Branch > John)
Entrance Branch > John Branch

This encapsulates possible start > end combinations
we cannot use a faulty end branch, for example, because such a path would be shrunk away

now the question is if this process takes too long because we have to redo it every time we finish a level to remove the new bad paths
maybe we can devise a better algorithm since all we're doing is removing bad paths.
we would just flow through from each initial node along every path and do only the shrink process to trim dead end paths

Pairs of levels would be treated as a single MVP layer, which means we calculate MVP layers for the following first:

Entrance > John
(Start Branch > End Branch)
(Start Branch > John Branch)
Entrance Branch > John Branch
(End Branch > John)

Then use those pairs to calculate the following larger MVP layers:

Entrance > (Start Branch > End Branch) > John
Entrance > (Start Branch > John Branch)
Entrance Branch > (End Branch > John)


these paired MVP layers could be treated as just one big room with multiple entrances/exits and paths through it
we could add one or more of these inbetween any existing "rooms" with the same process we would use to add new rooms inbetween MVPs


Adding rooms to Minium Viable Paths:

    Additional rooms are, by definition, redundant. That means that at least one of the rooms will have a redundant exit type.
    when we add a room, we either add a single room whose entrance and exits match the exit and entrance of the adjacent rooms OR a series of rooms that do the same
    
    therefore, we could use a similar process to construct "minimum viable paths" of a series of rooms
    but the intention is NOT to connect to an entrance/john transition, but just any possible type of transition
    
    maybe this means when we identify a redundant path that stops growing, we dont just remove it, we transplant it to another layer
    all these paths can then be used to connect existing MVPs after choosing.
    and we could not just add a redundant path to a MVP but we can add a redundant path inbetween an existing redundant path, if necessary, to increase the size of the path as needed
    
the larger logic of all of this could treat any "layer" as we would a room, ignoring its insides and inspecting only the start and exit types

what about when start a new layer? which exit paths should connect?
we should use all of them, even if they connect to at least one endpoint entrance
this si because the shrink phase will desize them if it goes bad and teh redundancy check ensures we dont get duplicate path exits branching from the same path

the initial transition nodes may be redundant now since we are actually connecting the layers together
similar reasoning to why when we combined the start and exit layers into one we removed the redundant node that would otherwise help connect them





























